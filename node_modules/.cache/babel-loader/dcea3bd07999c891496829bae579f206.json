{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u6211\\u7684\\u5C0F\\u53EF\\u7231\\\\Desktop\\\\miaomiao\\\\catEyes\\\\src\\\\views\\\\cinema\\\\index.js\";\n// 主页\nimport React, { Component } from 'react';\nimport { Link } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport ChooseCard from \"../../components/ChooseCard\";\nimport Nav from \"../../components/Nav\";\nimport Headers from \"../../components/Headers\";\nimport \"../../assets/css/cinema/index.css\";\nimport iconCard from \"../../assets/images/icon_card.png\";\nimport NoCinema from \"../../components/NoCinema\";\nimport { getAllCinemaList, getMoreCinema } from \"../../store/actions/Cinema/index\";\n\nclass Cinema extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      pageIndex: 1,\n      cinema: []\n    };\n  }\n\n  componentDidMount() {\n    localStorage.areaId = -1;\n    localStorage.districtId = -1;\n    localStorage.lineId = -1;\n    localStorage.hallType = -1;\n    localStorage.brandId = -1;\n    localStorage.serviceId = -1;\n    localStorage.areaId = -1;\n    localStorage.stationId = -1;\n    this.props.getAllCinemaList();\n  }\n\n  handlerScroll() {\n    this.props.getMoreCinema({\n      offset: 20 * this.state.pageIndex,\n      districtId: localStorage.districtId,\n      lineId: localStorage.lineId,\n      hallType: localStorage.hallType,\n      brandId: localStorage.brandId,\n      serviceId: localStorage.serviceId,\n      areaId: localStorage.areaId,\n      stationId: localStorage.stationId\n    });\n    this.setState({\n      pageIndex: this.state.pageIndex / 1 + 1\n    });\n  }\n\n  componentWillReceiveProps() {\n    window.addEventListener('scroll', () => (document.body.scrollTop || document.documentElement.scrollTop) > 1830 + 2280 * (this.state.pageIndex - 1) ? this.handlerScroll() : null);\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    if (nextProps.seats === this.props.seats && nextProps.seats.cinemas) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  render() {\n    let _this$props = this.props,\n        posts = _this$props.posts,\n        seats = _this$props.seats;\n\n    if (JSON.stringify(posts) === \"{}\") {\n      return null;\n    } else {\n      JSON.stringify(seats) !== \"{}\" ? posts.cinemas = [...posts.cinemas, ...seats.cinemas.slice(seats.cinemas.length - 20)] : posts.cinemas = [...posts.cinemas];\n      return React.createElement(\"div\", {\n        className: \"cineam_wrap\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"cinema\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, React.createElement(Headers, {\n        to: \"/cinema\",\n        label: \"\\u5F71\\u9662\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"main\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"cinema_tabbar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"citylist\",\n        className: \"choose_city\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      }, localStorage.name ? localStorage.name : '北京'), React.createElement(\"p\", {\n        className: \"triangle_gray\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      })), React.createElement(Link, {\n        to: \"search\",\n        className: \"search_cinema\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"iconfont\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, \"\\uE68D \\u641C\\u7D22\"))), React.createElement(\"div\", {\n        className: \"main\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, posts.cinemas.length > 0 ? React.createElement(\"ul\", {\n        className: \"cinema_list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, posts.cinemas.map((v, k) => {\n        return React.createElement(\"li\", {\n          key: v.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        }, React.createElement(Link, {\n          to: \"/cinema/shows/\" + v.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"cinema_name\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 93\n          },\n          __self: this\n        }, v.nm), React.createElement(\"span\", {\n          className: \"q\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"price\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94\n          },\n          __self: this\n        }, \"  \", v.sellPrice), \"  \\u5143\\u8D77\")), React.createElement(\"div\", {\n          className: \"address\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"adderss_fir\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97\n          },\n          __self: this\n        }, v.addr), React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, v.distance)), React.createElement(\"div\", {\n          className: \"card\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }, v.tag.allowRefund ? React.createElement(\"p\", {\n          style: {\n            color: \"#589daf\",\n            borderColor: \"#589daf\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 101\n          },\n          __self: this\n        }, \"\\u9000\") : null, v.tag.endorse ? React.createElement(\"p\", {\n          style: {\n            color: \"#589daf\",\n            borderColor: \"#589daf\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 102\n          },\n          __self: this\n        }, \"\\u6539\\u7B7E\") : null, v.tag.snack ? React.createElement(\"p\", {\n          style: {\n            color: \"#f90\",\n            borderColor: \"#f90\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 103\n          },\n          __self: this\n        }, \"\\u5C0F\\u5403\") : null, v.tag.vipTag ? React.createElement(\"p\", {\n          style: {\n            color: \"#f90\",\n            borderColor: \"#f90\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104\n          },\n          __self: this\n        }, \"\\u6298\\u6263\\u5361\") : null, v.tag.hallTypeVOList.length > 0 ? v.tag.hallTypeVOList.map((item, key) => {\n          return React.createElement(\"p\", {\n            style: {\n              color: \"#589daf\",\n              borderColor: \"#589daf\"\n            },\n            key: key,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 108\n            },\n            __self: this\n          }, item.name);\n        }) : null), React.createElement(\"div\", {\n          className: \"discount\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: iconCard,\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        }), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 115\n          },\n          __self: this\n        }, v.promotion.cardPromotionTag ? v.promotion.cardPromotionTag : \"暂无优惠\"))));\n      })) : React.createElement(NoCinema, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }))), React.createElement(ChooseCard, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }), React.createElement(Nav, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      })));\n    }\n  }\n\n}\n\nconst mapStateTpProps = state => ({\n  posts: state.posts.items,\n  seats: state.posts.seats\n});\n\nexport default connect(mapStateTpProps, {\n  getAllCinemaList,\n  getMoreCinema\n})(Cinema);","map":{"version":3,"sources":["C:\\Users\\我的小可爱\\Desktop\\miaomiao\\catEyes\\src\\views\\cinema\\index.js"],"names":["React","Component","Link","connect","ChooseCard","Nav","Headers","iconCard","NoCinema","getAllCinemaList","getMoreCinema","Cinema","constructor","props","state","pageIndex","cinema","componentDidMount","localStorage","areaId","districtId","lineId","hallType","brandId","serviceId","stationId","handlerScroll","offset","setState","componentWillReceiveProps","window","addEventListener","document","body","scrollTop","documentElement","shouldComponentUpdate","nextProps","nextState","seats","cinemas","render","posts","JSON","stringify","slice","length","name","map","v","k","id","nm","sellPrice","addr","distance","tag","allowRefund","color","borderColor","endorse","snack","vipTag","hallTypeVOList","item","key","promotion","cardPromotionTag","mapStateTpProps","items"],"mappings":"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","sourcesContent":["// 主页\r\nimport React, { Component } from 'react'\r\nimport { Link } from \"react-router-dom\"\r\nimport { connect } from \"react-redux\"\r\nimport ChooseCard from \"../../components/ChooseCard\"\r\nimport Nav from \"../../components/Nav\"\r\nimport Headers from \"../../components/Headers\"\r\nimport \"../../assets/css/cinema/index.css\"\r\nimport iconCard from \"../../assets/images/icon_card.png\"\r\nimport NoCinema from \"../../components/NoCinema\"\r\n\r\nimport { getAllCinemaList,getMoreCinema } from \"../../store/actions/Cinema/index\"\r\n\r\nclass Cinema extends Component {\r\n    constructor(props){\r\n        super(props)\r\n        this.state={\r\n            pageIndex : 1,\r\n            cinema : []\r\n        }\r\n    }\r\n    componentDidMount(){\r\n        localStorage.areaId=-1\r\n        localStorage.districtId=-1\r\n        localStorage.lineId=-1\r\n        localStorage.hallType=-1\r\n        localStorage.brandId=-1\r\n        localStorage.serviceId=-1\r\n        localStorage.areaId=-1\r\n        localStorage.stationId=-1\r\n        this.props.getAllCinemaList();\r\n    }\r\n    handlerScroll(){\r\n        this.props.getMoreCinema({offset:20*this.state.pageIndex,\r\n            districtId:localStorage.districtId,\r\n            lineId:localStorage.lineId,\r\n            hallType:localStorage.hallType,\r\n            brandId:localStorage.brandId,\r\n            serviceId:localStorage.serviceId,\r\n            areaId:localStorage.areaId,\r\n            stationId:localStorage.stationId\r\n        })\r\n        this.setState({\r\n            pageIndex : this.state.pageIndex/1+1\r\n        })\r\n    }\r\n    componentWillReceiveProps(){\r\n            window.addEventListener('scroll', () =>\r\n                (document.body.scrollTop || document.documentElement.scrollTop)>1830+2280*(this.state.pageIndex-1)?\r\n                    this.handlerScroll()\r\n                :null\r\n            )\r\n        \r\n    }\r\n    shouldComponentUpdate(nextProps,nextState){\r\n        if(nextProps.seats===this.props.seats&&nextProps.seats.cinemas){\r\n            return false\r\n        }else{\r\n            return true\r\n        }\r\n    }\r\n    render() {\r\n        let { posts,seats } = this.props\r\n        if(JSON.stringify(posts) === \"{}\"){\r\n            return(\r\n                null\r\n            )\r\n        }\r\n        else{\r\n            JSON.stringify(seats)!==\"{}\"?posts.cinemas = [...posts.cinemas,...seats.cinemas.slice(seats.cinemas.length-20)]:posts.cinemas=[...posts.cinemas]\r\n            return (\r\n                <div className=\"cineam_wrap\">\r\n                    <div className=\"cinema\">\r\n                        <Headers to=\"/cinema\" label=\"影院\"></Headers>\r\n                    <div className=\"main\">\r\n                        <div className=\"cinema_tabbar\">\r\n                            <Link to=\"citylist\" className=\"choose_city\">\r\n                                <p>{localStorage.name?localStorage.name:'北京'}</p>\r\n                                <p className=\"triangle_gray\"></p>\r\n                            </Link>\r\n                            <Link to=\"search\" className=\"search_cinema\">\r\n                                <p className=\"iconfont\">&#xe68d; 搜索</p>\r\n                            </Link>\r\n                        </div>\r\n                        <div className=\"main\">\r\n                            {posts.cinemas.length>0 ? \r\n                                <ul className=\"cinema_list\">\r\n                                    {posts.cinemas.map((v,k)=>{\r\n                                        return(\r\n                                            <li key={v.id}>\r\n                                                <Link to={\"/cinema/shows/\"+v.id}>\r\n                                                    <div className=\"cinema_name\">\r\n                                                        <span>{v.nm}</span>\r\n                                                        <span className=\"q\"><span className=\"price\">  {v.sellPrice}</span>  元起</span>\r\n                                                    </div>\r\n                                                    <div className=\"address\">\r\n                                                        <span className=\"adderss_fir\">{v.addr}</span>\r\n                                                        <span>{v.distance}</span>\r\n                                                    </div>\r\n                                                    <div className=\"card\">\r\n                                                        {v.tag.allowRefund ? <p style={{color:\"#589daf\",borderColor:\"#589daf\"}}>退</p> :null}\r\n                                                        {v.tag.endorse ? <p style={{color:\"#589daf\",borderColor:\"#589daf\"}}>改签</p> :null}\r\n                                                        {v.tag.snack ? <p style={{color:\"#f90\",borderColor:\"#f90\"}}>小吃</p> :null}\r\n                                                        {v.tag.vipTag ? <p style={{color:\"#f90\",borderColor:\"#f90\"}}>折扣卡</p> :null} \r\n                                                        {v.tag.hallTypeVOList.length>0? v.tag.hallTypeVOList.map(\r\n                                                            (item,key)=>{\r\n                                                                return(\r\n                                                                    <p style={{color:\"#589daf\",borderColor:\"#589daf\"}} key={key}>{item.name}</p>\r\n                                                                )\r\n                                                            }\r\n                                                        )  : null}\r\n                                                    </div>\r\n                                                    <div className=\"discount\">\r\n                                                        <img src={iconCard} alt=\"\"/>\r\n                                                        <p>{v.promotion.cardPromotionTag ? v.promotion.cardPromotionTag : \"暂无优惠\"}</p>\r\n                                                    </div>\r\n                                                </Link>\r\n                                            </li>\r\n                                        )\r\n                                    })}\r\n                                </ul> \r\n                            : <NoCinema></NoCinema>}\r\n                            \r\n                        </div>\r\n                    </div>\r\n                    <ChooseCard></ChooseCard>\r\n                    <Nav></Nav>\r\n                    </div>\r\n                </div>\r\n                \r\n            ) \r\n        }\r\n            \r\n        \r\n        \r\n    }\r\n}\r\n\r\n\r\nconst mapStateTpProps = state =>({\r\n    posts : state.posts.items,\r\n    seats : state.posts.seats\r\n})\r\nexport default connect(mapStateTpProps,{ getAllCinemaList,getMoreCinema })(Cinema)"]},"metadata":{},"sourceType":"module"}